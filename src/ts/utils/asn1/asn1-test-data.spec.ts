import {
  PolicySchedule,
  PolicyTemplate,
  ProvenanceDataSchema,
  SignatureRS,
  SubjectPublicKeyInfo,
  TxDigestPathInt,
} from "../../types";

export const TEST_SAMPLE_RECOVERERS_DER_COMPLEX =
  "308201F63082015A308201560201023082014F04410409ECA5D742FA7BC31373BF18B14AF9B102BBE51C729AF2DD8067DC5BFD35E49EB1044B69D49FC72C350F55B814DBEA65E21FE16870846258977D60EDED612EC30441040123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF044104008DA5D742FA7BC31373BF18B14AF9B102BBE51C729AF2DD8067DC5BFD35E49EB1044B69D49FC72C350F55B814DBEA65E21FE16870846258977D60EDED612EC30441040274930742FA7BC31373BF18B14AF9B102BBE51C729AF2DD8067DC5BFD35E49EB1044B69D49FC72C350F55B814DBEA65E21FE16870846258977D60EDED612EC3044104999837D742FA7BC31373BF18B14AF9B102BBE51C729AF2DD8067DC5BFD35E49EB1044B69D49FC72C350F55B814DBEA65E21FE16870846258977D60EDED612EC3304A3048020101304304410400115D742FA7BC31373BF18B14AF9B102BBE51C729AF2DD8067DC5BFD35E49EB1044B69D49FC72C350F55B814DBEA65E21FE16870846258977D60EDE4D612EC3304A30480201013043044104345678742FA7BC31373BF18B14AF9B102BBE51C729AF2DD8067DC5BFD35E49EB1044B69D49FC72C350F55B814DBEA65E21FE168708462582977D60EDED612EC3";

export const TEST_SAMPLE_RECOVERERS_COMPLEX: PolicySchedule[] = [
  [
    {
      quorumCount: 2,
      keys: [
        "0409eca5d742fa7bc31373bf18b14af9b102bbe51c729af2dd8067dc5bfd35e49eb1044b69d49fc72c350f55b814dbea65e21fe16870846258977d60eded612ec3",
        "040123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef",
        "04008da5d742fa7bc31373bf18b14af9b102bbe51c729af2dd8067dc5bfd35e49eb1044b69d49fc72c350f55b814dbea65e21fe16870846258977d60eded612ec3",
        "040274930742fa7bc31373bf18b14af9b102bbe51c729af2dd8067dc5bfd35e49eb1044b69d49fc72c350f55b814dbea65e21fe16870846258977d60eded612ec3",
        "04999837d742fa7bc31373bf18b14af9b102bbe51c729af2dd8067dc5bfd35e49eb1044b69d49fc72c350f55b814dbea65e21fe16870846258977d60eded612ec3",
      ],
    },
  ],
  [
    {
      quorumCount: 1,
      keys: [
        "0400115d742fa7bc31373bf18b14af9b102bbe51c729af2dd8067dc5bfd35e49eb1044b69d49fc72c350f55b814dbea65e21fe16870846258977d60ede4d612ec3",
      ],
    },
  ],
  [
    {
      quorumCount: 1,
      keys: [
        "04345678742fa7bc31373bf18b14af9b102bbe51c729af2dd8067dc5bfd35e49eb1044b69d49fc72c350f55b814dbea65e21fe168708462582977d60eded612ec3",
      ],
    },
  ],
];

export const TEST_POLICY_TEMPLATE_3D_3R_DER =
  "30820216020500FFFFFFFF308201273082012330818C02010130818604410409ECA5D742FA7BC31373BF18B14AF9B102BBE51C729AF2DD8067DC5BFD35E49EB1044B69D49FC72C350F55B814DBEA65E21FE16870846258977D60EDED612EC30441040123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF3048020101304304410409ECA5D742FA7BC31373BF18B14AF9B102BBE51C729AF2DD8067DC5BFD35E49EB1044B69D49FC72C350F55B814DBEA65E21FE16870846258977D60EDED612EC33048020101304304410409ECA5D742FA7BC31373BF18B14AF9B102BBE51C729AF2DD8067DC5BFD35E49EB1044B69D49FC72C350F55B814DBEA65E21FE16870846258977D60EDED612EC33081E13081DE3048020101304304410409ECA5D742FA7BC31373BF18B14AF9B102BBE51C729AF2DD8067DC5BFD35E49EB1044B69D49FC72C350F55B814DBEA65E21FE16870846258977D60EDED612EC33048020101304304410409ECA5D742FA7BC31373BF18B14AF9B102BBE51C729AF2DD8067DC5BFD35E49EB1044B69D49FC72C350F55B814DBEA65E21FE16870846258977D60EDED612EC33048020101304304410409ECA5D742FA7BC31373BF18B14AF9B102BBE51C729AF2DD8067DC5BFD35E49EB1044B69D49FC72C350F55B814DBEA65E21FE16870846258977D60EDED612EC3";

export const TEST_POLICY_TEMPLATE_3D_3R: PolicyTemplate = {
  type: "POLICY_TEMPLATE",
  expiryTimestamp: 4294967295,
  delegateSchedules: [
    [
      {
        quorumCount: 1,
        keys: [
          "0409eca5d742fa7bc31373bf18b14af9b102bbe51c729af2dd8067dc5bfd35e49eb1044b69d49fc72c350f55b814dbea65e21fe16870846258977d60eded612ec3",
          "040123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef",
        ],
      },
      {
        quorumCount: 1,
        keys: [
          "0409eca5d742fa7bc31373bf18b14af9b102bbe51c729af2dd8067dc5bfd35e49eb1044b69d49fc72c350f55b814dbea65e21fe16870846258977d60eded612ec3",
        ],
      },
      {
        quorumCount: 1,
        keys: [
          "0409eca5d742fa7bc31373bf18b14af9b102bbe51c729af2dd8067dc5bfd35e49eb1044b69d49fc72c350f55b814dbea65e21fe16870846258977d60eded612ec3",
        ],
      },
    ],
  ],
  recovererSchedules: [
    [
      {
        quorumCount: 1,
        keys: [
          "0409eca5d742fa7bc31373bf18b14af9b102bbe51c729af2dd8067dc5bfd35e49eb1044b69d49fc72c350f55b814dbea65e21fe16870846258977d60eded612ec3",
        ],
      },
      {
        quorumCount: 1,
        keys: [
          "0409eca5d742fa7bc31373bf18b14af9b102bbe51c729af2dd8067dc5bfd35e49eb1044b69d49fc72c350f55b814dbea65e21fe16870846258977d60eded612ec3",
        ],
      },
      {
        quorumCount: 1,
        keys: [
          "0409eca5d742fa7bc31373bf18b14af9b102bbe51c729af2dd8067dc5bfd35e49eb1044b69d49fc72c350f55b814dbea65e21fe16870846258977d60eded612ec3",
        ],
      },
    ],
  ],
};

export const TEST_POLICY_TEMPLATE_DER_1D_5R =
  "308201B602045B9BDE7C304C304A304802010130430441044595B77DD9758D382268BAC9F82F02640FAB533B222E597F6C82E66D53D1FAA01DC190FF17729C62763CFFC7F7ABC0E72D24243FF0773BFA8C70374A18B2180E3082015E3082015A308201560201013082014F044104BA787D4EDDFE115B5B75718DDB23F351C07FD33B1B749F9670BC3990D5637456F16E230C87083DB999110D2D83C019B958E4B92D9D9CDE772FB2F4F8D0D8A443044104BA787D4EDDFE115B5B75718DDB23F351C07FD33B1B749F9670BC3990D5637456F16E230C87083DB999110D2D83C019B958E4B92D9D9CDE772FB2F4F8D0D8A443044104BA787D4EDDFE115B5B75718DDB23F351C07FD33B1B749F9670BC3990D5637456F16E230C87083DB999110D2D83C019B958E4B92D9D9CDE772FB2F4F8D0D8A443044104BA787D4EDDFE115B5B75718DDB23F351C07FD33B1B749F9670BC3990D5637456F16E230C87083DB999110D2D83C019B958E4B92D9D9CDE772FB2F4F8D0D8A443044104BA787D4EDDFE115B5B75718DDB23F351C07FD33B1B749F9670BC3990D5637456F16E230C87083DB999110D2D83C019B958E4B92D9D9CDE772FB2F4F8D0D8A443";

export const TEST_POLICY_TEMPLATE_1D_5R: PolicyTemplate = {
  type: "POLICY_TEMPLATE",
  expiryTimestamp: 1536941692,
  delegateSchedules: [
    [
      {
        quorumCount: 1,
        keys: [
          "044595b77dd9758d382268bac9f82f02640fab533b222e597f6c82e66d53d1faa01dc190ff17729c62763cffc7f7abc0e72d24243ff0773bfa8c70374a18b2180e",
        ],
      },
    ],
  ],
  recovererSchedules: [
    [
      {
        quorumCount: 1,
        keys: [
          "04ba787d4eddfe115b5b75718ddb23f351c07fd33b1b749f9670bc3990d5637456f16e230c87083db999110d2d83c019b958e4b92d9d9cde772fb2f4f8d0d8a443",
          "04ba787d4eddfe115b5b75718ddb23f351c07fd33b1b749f9670bc3990d5637456f16e230c87083db999110d2d83c019b958e4b92d9d9cde772fb2f4f8d0d8a443",
          "04ba787d4eddfe115b5b75718ddb23f351c07fd33b1b749f9670bc3990d5637456f16e230c87083db999110d2d83c019b958e4b92d9d9cde772fb2f4f8d0d8a443",
          "04ba787d4eddfe115b5b75718ddb23f351c07fd33b1b749f9670bc3990d5637456f16e230c87083db999110d2d83c019b958e4b92d9d9cde772fb2f4f8d0d8a443",
          "04ba787d4eddfe115b5b75718ddb23f351c07fd33b1b749f9670bc3990d5637456f16e230c87083db999110d2d83c019b958e4b92d9d9cde772fb2f4f8d0d8a443",
        ],
      },
    ],
  ],
};

export const TEST_PUBLICKEY_DER = Buffer.from(
  "3059301306072a8648ce3d020106082a8648ce3d0301070342000461178348277d03cbca752806e5ec66d61b07952accfb79cf48931240278aea481459b10d01874e0b026628fd5f95ce7440e931d1630d322cfeba28712ffaa8be",
  "hex",
);

export const TEST_SUBJECT_PUBLICKEY_INFO: SubjectPublicKeyInfo = {
  algorithmIdentifier: { algorithm: "1.2.840.10045.2.1", parameters: "1.2.840.10045.3.1.7" },
  subjectPublicKey: Buffer.from(
    "0461178348277d03cbca752806e5ec66d61b07952accfb79cf48931240278aea481459b10d01874e0b026628fd5f95ce7440e931d1630d322cfeba28712ffaa8be",
    "hex",
  ),
};

export const TEST_SIGNATURE_DER = Buffer.from(
  "3045022013A842C5C965E925C46EDD220D8910886F28C35EF965D372AFDF1923A8B941C0022100A669EEDD1A558643787B969F181DF293B8AFD7791B555AAC2F23C329B6C6BDD3",
  "hex",
);

export const TEST_SIGNATURE: SignatureRS = {
  r: Buffer.from("13a842c5c965e925c46edd220d8910886f28c35ef965d372afdf1923a8b941c0", "hex"),
  s: Buffer.from("a669eedd1a558643787b969f181df293b8afd7791b555aac2f23c329b6c6bdd3", "hex"),
};

// Test publicKey provenance
export const TEST_PROVENANCE: ProvenanceDataSchema = {
  walletId: "2d4f763f-f97d-436f-b1ab-874633a8c09a",
  path: [2147483721, 2147483648, 2147483648, 1, 37],
  publicKey:
    "0464f45d97776a1f43113bd209c4a71054e300cafa387e554e7a6c66cc13ffaa64a3419dcee67bff48f9bc492779ac76e1b1fa966b30a5118eff613c6155c50d4f",
};

// Testing path in Hex
export const TEST_PROVENANCE_IN_HEX: ProvenanceDataSchema = {
  walletId: "2d4f763f-f97d-436f-b1ab-874633a8c09a",
  path: [0x80000049, 0x80000000, 0x80000000, 0x1, 0x25],
  publicKey:
    "0464f45d97776a1f43113bd209c4a71054e300cafa387e554e7a6c66cc13ffaa64a3419dcee67bff48f9bc492779ac76e1b1fa966b30a5118eff613c6155c50d4f",
};

// DER encoding of a provenance data
export const TEST_PROVENANCE_DER =
  "308186132432643466373633662D663937642D343336662D623161622D383734363333613863303961301B02050080000049020500800000000205008000000002010102012504410464F45D97776A1F43113BD209C4A71054E300CAFA387E554E7A6C66CC13FFAA64A3419DCEE67BFF48F9BC492779AC76E1B1FA966B30A5118EFF613C6155C50D4F";

// A transaction with path as number
export const TEST_TRANSACTION: TxDigestPathInt = {
  digest: "c1ae20f9b29fb44e30a0dc15b2240821b4401ae659979f26c37e0b00ca679b4b",
  path: [2147483716, 2147483744, 2147483648, 0, 0],
};

// DER Transaction
export const TEST_TRANSACTION_DER =
  "303F0420C1AE20F9B29FB44E30A0DC15B2240821B4401AE659979F26C37E0B00CA679B4B301B020500800000440205008000006002050080000000020100020100";
